<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kean Cart Quantity</title>
    <link rel="stylesheet" href="../css/style.css" />
  </head>
  <body>
    <button onclick="history.back();" class="go-back">ðŸ‘ˆGo Back</button>
    <p>Adults Plain Cotton T-shirt</p>
    <p>Price: $7.99</p>
    <button onclick="addToCart2()" class="add-tocart-js yellow-color">
      Add to cart
    </button>

    <button class="orange-color" onclick="handleBuyNow()">Buy now</button>
    <p class="add-tocart-text-js"></p>
    <hr />

    <p>Cart Quantity</p>
    <button onclick="showCartQty(quantity);">Show Quantity</button>
    <button onclick="addToCart(1);">Add to Cart</button>
    <button onclick="addToCart(2)">+2</button>
    <button onclick="addToCart(3)">+3</button>
    <button onclick="addToCart(4)">+4</button>
    <button onclick="addToCart(5)">+5</button>

    <button onclick="removeCart(1);">Remove from cart</button>
    <button onclick="removeCart(2)">-2</button>
    <button onclick="removeCart(3);">-3</button>
    <button onclick="cartReset(quantity)" class="reset-js">Reset Cart</button>
    <p class="display-qty-js"></p>
  </body>
  <script>
    const addToCartEl = document.querySelector(".add-tocart-js");
    const addToCartTextDisplay = document.querySelector(".add-tocart-text-js");
    let timeoutID;
    function addToCart2() {
      addToCartTextDisplay.innerHTML = "Added";
      clearTimeout(timeoutID);
      timeoutID = setTimeout(() => {
        addToCartTextDisplay.innerHTML = "";
      }, 2000);
    }
    let quantity = JSON.parse(localStorage.getItem("quantity")) || 0;
    let maxQuantity = 10;
    const displayQtyEl = document.querySelector(".display-qty-js");

    const btns = document.querySelectorAll("button");
    const resetBtnEl = document.querySelector(".reset-js");
    resetBtnEl.disabled = !quantity && true;

    function addToCart(qty) {
      if (quantity + qty > maxQuantity) {
        alert(`The cart is full!`);
        return;
      }
      quantity = quantity += qty;
      localStorage.setItem("quantity", quantity);
      showCartQty(quantity);
      resetBtnEl.disabled = false;
    }

    function removeCart(qty) {
      if (quantity - qty >= 0) {
        quantity = quantity - qty;
        localStorage.setItem("quantity", quantity);
        showCartQty(quantity);
        return;
      }
      alert("Not enough items");
    }
    function handleBuyNow() {
      console.log("Loading...");
      alert("Purchased!");
    }

    function cartReset() {
      quantity = 0;
      localStorage.setItem("quantity", quantity);
      resetBtnEl.disabled = true;

      showCartQty(quantity, "Cart was reset!<br />");
      btns.forEach((btn) => (btn.disabled = true));

      setTimeout(() => {
        showCartQty(quantity);
        btns.forEach((btn) => (btn.disabled = false));
        resetBtnEl.disabled = true;
      }, 1000);
    }

    function showCartQty(show_qty, msg = "") {
      displayQtyEl.innerHTML = `${msg}Cart quantity: ${show_qty}`;
    }

    showCartQty(quantity);
  </script>
  <!-- <script src="script.js"></script> -->
</html>
